<!--_meta 作为公共模版分离出去-->
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<link rel="Bookmark" href="favicon.ico" >
<link rel="Shortcut Icon" href="favicon.ico" />
<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="__ADMIN__static/h-ui/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="__ADMIN__static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="__ADMIN__lib/Hui-iconfont/1.0.8/iconfont.css" />
<link rel="stylesheet" type="text/css" href="__ADMIN__static/h-ui.admin/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="__ADMIN__static/h-ui.admin/css/style.css" />
<!--[if IE 6]>
<script type="text/javascript" src="http://lib.h-ui.net/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script><![endif]-->
<!--/meta 作为公共模版分离出去-->

<link href="__ADMIN__lib/webuploader/0.1.5/webuploader.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div class="page-container">
	<form action="http://angel.qvbilam.xin/admin/video/videoAddDo" method="post" class="form form-horizontal" id="form-article-add" enctype="multipart/form-data">
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>视频板块：</label>
			<div class="formControls col-xs-8 col-sm-9"> <span class="select-box">
				<select name="vbank" class="select">
					<option value="">请选择板块</option>
					{volist name='vbank' id='vbankval'}
					<option value="{$vbankval.id}">{$vbankval.bankname}</option>
					{/volist}
				</select>
				</span> </div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">视频类别：</label>
			<div class="formControls col-xs-8 col-sm-9"> <span class="select-box">
				<select name="vclass" class="select">
				
				</select>
				</span> </div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">视频风格：</label>
			<div class="formControls col-xs-8 col-sm-9"> <span class="select-box">
				<select name="vstyle" class="select">
					
				</select>
				</span> </div>
		</div><div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">视频产地：</label>
			<div class="formControls col-xs-8 col-sm-9"> <span class="select-box">
				<select name="vplace" class="select">
					
				</select>
				</span> </div>
		</div>

		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">
				<span class="c-red">*</span>视频名称：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="" name="videoname" required>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>视频集数：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="number" class="input-text" placeholder="" id="" name="num" required>
			</div>
		</div>
		
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">允许评论：</label>
			<div class="formControls col-xs-8 col-sm-9 skin-minimal">
				<div class="check-box">
					<input type="radio" id="radio-1" name="vpost" checked value='1'>
					<label for="radio-1">允许</label>&emsp;
					<input type="radio" id="radio-2" name="vpost" value='0'>
					<label for="radio-2">不允许</label>
				</div>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">观看权限：</label>
			<div class="formControls col-xs-8 col-sm-9 skin-minimal">
				<div class="check-box">
					<input type="radio" id="radio-3" name="quanxian" value='0' checked>
					<label for="radio-3">免费</label>&emsp;
					<input type="radio" id="radio-4" name="quanxian" value='1'>
					<label for="radio-4">会员</label>
				</div>
			</div>
		</div>	
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">视频封面：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="file" name="vpic">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">内容封面：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="file" name="vpica">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">视频文件：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="file" name="vsrc" required>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">视频介绍：</label>
			<div class="formControls col-xs-8 col-sm-9"> 
				<input type="text" class="input-text" name="countent" >
			</div>
		</div>
		<div class="row cl">
			<div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-2">
				<button onClick="article_save_submit();" class="btn btn-primary radius" type="submit"></i>&nbsp;&nbsp;上传&nbsp;&nbsp;</button>
				
				<button onClick="layer_close();" class="btn btn btn-danger radius" type="resetBtn">&nbsp;&nbsp;重置&nbsp;&nbsp;</button>
			</div>
		</div>
	</form>
</div>
<script type="text/javascript" src="__ADMIN__lib/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="__ADMIN__lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="__ADMIN__static/h-ui/js/H-ui.js"></script> 
<script type="text/javascript" src="__ADMIN__static/h-ui.admin/js/H-ui.admin.page.js"></script>
<script type="text/javascript" src="__ADMIN__lib/jquery.validation/1.14.0/jquery.validate.js"></script> 
<script type="text/javascript" src="__ADMIN__lib/jquery.validation/1.14.0/validate-methods.js"></script> 
<script type="text/javascript" src="__ADMIN__lib/jquery.validation/1.14.0/messages_zh.js"></script> 
<script type="text/javascript" src="__ADMIN__lib/webuploader/0.1.5/webuploader.min.js"></script> 
<script type="text/javascript" src="__ADMIN__lib/ueditor/1.4.3/ueditor.config.js"></script>
<script type="text/javascript" src="__ADMIN__lib/ueditor/1.4.3/ueditor.all.min.js"> </script>
<script type="text/javascript" src="__ADMIN__lib/ueditor/1.4.3/lang/zh-cn/zh-cn.js"></script>
</body>
</html>
<script type="text/javascript">

	//获取所有select
	$.ajax({
		url: 'http://angel.qvbilam.xin/admin/videoajax/videoajax',
  		type: 'post',
  		success:success
	});
	//查看tovideo有无此名字;没有就必须是第一集
	$('input[name="videoname"]').blur(function () {
		name = $('input[name="videoname"]').val();
		$.ajax({
		url: 'http://angel.qvbilam.xin/admin/tovideoajax/tovideoajax',
  		type: 'post',
  		data: "name="+name,
  		success:tovideo
		});
	});
	function tovideo($data)
	{
		console.log($data);
		if ($data != 1){
			$('input[name="num"]').val(1).attr("disabled",true);;
		}else{
			$('input[name="num"]').attr("disabled",false);;
			namenum = $('input[name="videoname"]').val();
			$.ajax({
				url: 'http://angel.qvbilam.xin/admin/Videoajax/videonumajax',
  				type: 'post',
  				data: "num="+namenum,
  				success:videonum
			});
		}
	}
	function videonum($data)
	{
		var data = JSON.parse($data);
		console.log(data[0]['videonum']);
		$('input[name="num"]').blur(function() {
			for(var i=0;i<$data.length;i++){
				if($('input[name="num"]').val()==data[i]['videonum']){
					alert('该集已存在');
				}
			}
		});
	}
	function success($data)
	{
		$('.btn-primary').addClass('disabled');
		var data = JSON.parse($data);
		console.log(data);
		//地点
		for(var i=0;i<data.place.length;i++){
			$('select[name="vplace"]').append("<option value='"+data.place[i]['id']+"'>" + data.place[i]['placename'] + "</option>");
		}
		//bank改变函数开始
		$('select[name="vbank"]').change(function() {
			//获取bank下相对应的class值.
			if($('select[name="vbank"]').val() == ""){
				$('.btn-primary').addClass('disabled');
			}else{
				$('.btn-primary').removeClass('disabled');
			}
			var oSel = $('select[name="vbank"]').find("option:selected").text();
			$('select[name="vclass"]').html('<option value="">请选择'+ oSel +'类类别</option>');
			for(var i=0; i<data.class.length;i++)
			{
				if(data.class[i]['bid'] == $('select[name="vbank"]').val())
				{
					$('select[name="vclass"]').append("<option value='"+data.class[i]['id']+"'>" + data.class[i]['classname'] + "</option>");
				}	
			}
		});
		$('select[name="vclass"]').change(function(){
			$('select[name="vstyle"]').html('<option value="">请选择视频风格</option>');
			for(var i=0; i<data.style.length;i++)
			{
				if(data.style[i]['bid'] == $('select[name="vbank"]').val())
				{
					if(data.style[i]['cid'] == parseInt($('select[name="vclass"]').val()))
					{
						$('select[name="vstyle"]').append("<option value='"+data.style[i]['id']+"'>" + data.style[i]['stylename'] + "</option>");	
					}	
				}	
			}
		})
	}
</script>